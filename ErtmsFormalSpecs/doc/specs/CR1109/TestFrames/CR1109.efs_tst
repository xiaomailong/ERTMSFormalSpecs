<Frame
 CycleDuration="0.1"
 Name="CR1109"
 Guid="4f6dd272-df76-4131-b926-df5bf0d7aff0"
>
<SubSequences>
<SubSequence
 D_LRBG=""
 Level=""
 Mode=""
 NID_LRBG=""
 Q_DIRLRBG=""
 Q_DIRTRAIN=""
 Q_DLRBG=""
 RBC_ID=""
 RBCPhone=""
 Name="Degraded situation scenario"
 Guid="39d70b50-c21b-44a6-a928-b268cca4e565"
>
<TestCases>
<TestCase
 Name="Degraded situation scenario"
 Guid="3936d14c-2ba0-466d-b1a8-453e2c353476"
>
<ReqRef
 Id="a155d204-c214-45ff-a2b4-045e5aa12ba8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="1ea0bea2-683d-420d-8725-ffd92406136e"
>
</ReqRef><ReqRef
 Id="46ca4ea8-b495-4b75-8ec7-60ccf9444a55"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="06305a2d-2329-4f04-b274-517e6f35c6f6"
>
</ReqRef><ReqRef
 Id="22cbd162-caa0-4e5a-a581-176fc2b4b8bb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fb964583-b385-48de-922f-df393ec32573"
>
</ReqRef><ReqRef
 Id="555c0388-8b13-4052-acc3-48e9e785af1a"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="50b9316d-b050-4aad-83ae-bbf15cc751da"
>
</ReqRef><ReqRef
 Id="728d48f2-61c9-4dad-9800-8a9daa1cfbf9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f346c860-8d2c-4f1d-bf38-79d442728536"
>
</ReqRef><ReqRef
 Id="3622dce7-f18b-4dc7-8539-e2f01da0803b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="158cfd41-43ec-4cc5-991e-b22a2bea0d34"
>
</ReqRef><ReqRef
 Id="3f38b783-07e2-4c8a-bfd3-a5e8de65d29b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="840e9eb8-be28-4bb4-b18a-3bcedb11d225"
>
</ReqRef><Steps>
<Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 Name="Step1 - Setup"
 Guid="a668dd43-c91d-4e03-b704-925e50886443"
>
<SubSteps>
<SubStep
 Name="Sub-step1"
 Guid="a1d9dc63-d3a6-4338-b249-be4c91a5e7cc"
>
<Actions>
<Action
 Guid="6938995c-275f-4f2c-925a-ec3607e9f7c3"
>Kernel.InitializeTestEnvironment()</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 Name="Step2 - Provide data for normal case"
 Guid="23e3f2e5-c5b1-4fd0-92dd-0fc21b9e5e2a"
>
<Comment></Comment>
<SubSteps>
<SubStep
 Name="Sub-step1 - Odometry data"
 Guid="e963ec24-87da-48b1-b8af-fe92d6cdc8a9"
>
<Comment></Comment>
<Actions>
<Action
 Guid="d1a5b8a4-c1cd-47dd-813d-cca3cf8bb3f8"
>Odometry.EstimatedSpeed &lt;- 52.0</Action><Action
 Guid="4fd8b02d-11d4-4bc0-aa7b-d2ca48ddcbe5"
>Odometry.NominalDistance &lt;- 140.0</Action></Actions>
</SubStep><SubStep
 Name="Sub-step2 - LRBG + MA"
 Guid="9968a9bd-d179-4d2e-8da2-d6086468419c"
>
<Actions>
<Action
 Guid="144b970c-5c79-4018-ac14-36e47a59c836"
><Comment></Comment>
BTM.LRBG &lt;- BTM.BaliseGroup
{
    Position =&gt; BTM.Position
    {
        Position =&gt; 100.0,
        UnderReadingAmountOdo =&gt; 4.0,
        OverReadingAmountOdo =&gt; 8.0
    },
    NID =&gt; 2041,
    Orientation =&gt; Default.Orientation.Nominal
}</Action><Action
 Guid="07d1eff8-4b40-4266-a2ae-d1de93937102"
>Kernel.MA.MA &lt;- Kernel.MA.MovementAuthority
{
    TargetSpeed =&gt; 90.0,
    EndSection =&gt; Kernel.MA.EndSection
    {
        Length =&gt; 4000.0,
        DangerPoint =&gt; Kernel.MA.DangerPoint
        {
            Distance =&gt; 200.0,
            ReleaseSpeed =&gt; 25.0
        },
        Overlap =&gt; Kernel.MA.Overlap
        {
            Distance =&gt; 50.0,
            TimerDistance =&gt; 0.0,
            ReleaseSpeed =&gt; 25.0,
            TimeOut =&gt; 0.0
        }
    }
}</Action></Actions>
</SubStep><SubStep
 Name="Sub-step3 - Train data"
 Guid="c0a7e825-9b51-4807-b5cc-25f9af9f3ddc"
>
</SubStep><SubStep
 Name="Sub-step4 - Mode + Level"
 Guid="ba76eb62-42c6-43cc-8dde-4cff2346b865"
>
<Actions>
<Action
 Guid="16d94069-df89-4d11-8c21-de6d3bdc10ca"
>Kernel.Level.Value &lt;- Default.Level.L1</Action><Action
 Guid="e57d1e3a-8808-46c5-941a-6438647d311e"
>Kernel.Mode &lt;- Default.Mode.FS</Action></Actions>
</SubStep><SubStep
 Name="Sub-step5 - Non stopping area"
 Guid="0f513933-b8e1-4b38-9e5b-b20a762c3f10"
>
<Actions>
<Action
 Guid="ddebab7e-83a7-4c44-a9b3-269dc8efbb99"
><Comment>Provides a non-stopping area between 2000m and 2400m.</Comment>
BTM.Message &lt;- Messages.EUROBALISE.Message
{
    Q_UPDOWN =&gt; Messages.Q_UPDOWN.Up_link_telegram,
    M_VERSION =&gt; 1,
    Q_MEDIA =&gt; Messages.Q_MEDIA.Balise,
    N_PIG =&gt; 0,
    N_TOTAL =&gt; 0,
    M_DUP =&gt; Messages.M_DUP.No_duplicates,
    M_MCOUNT =&gt; 4,
    NID_C =&gt; 140,
    NID_BG =&gt; 2124,
    Q_LINK =&gt; Messages.Q_LINK.Unlinked,
    Sequence1 =&gt; [Messages.EUROBALISE.SubStructure1
    {
        TRACK_TO_TRAIN =&gt; Messages.PACKET.TRACK_TO_TRAIN.Message
        {
            TRACK_CONDITION =&gt; Messages.PACKET.TRACK_TO_TRAIN.TRACK_CONDITION.Message
            {
                NID_PACKET =&gt; 68,
                Q_DIR =&gt; 2,
                L_PACKET =&gt; 0,
                Q_SCALE =&gt; Messages.Q_SCALE._1_m_scaleC,
                Q_TRACKINIT =&gt; Messages.Q_TRACKINIT.No_initial_states_to_be_resumed__profile_to_follow,
                D_TRACKINIT =&gt; 0,
                D_TRACKCOND =&gt; 2000,
                L_TRACKCOND =&gt; 400,
                M_TRACKCOND =&gt; Messages.M_TRACKCOND.Non_stopping_area___tunnel__Initial_state__stopping_permitted,
                N_ITER =&gt; 0,
                Sequence1 =&gt; []
            }
        }
    }
]
}</Action></Actions>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 Name="Step3 - Check expectations"
 Guid="5881164d-e7e0-4275-a62c-cce263abe288"
>
<SubSteps>
<SubStep
 Name="Sub-step1 - The first SBI is not crossed yet =&gt; nothing is displayed"
 Guid="31f2e161-c60d-49fb-a6bb-602238b3057a"
>
<Actions>
<Action
 Guid="c90ae629-9e27-49ea-8b62-644b2c2b8b02"
><Comment></Comment>
Odometry.NominalDistance &lt;- 1960.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="057a9079-f374-405c-aab9-2ea4d2dc6807"
>Kernel.TrackDescription.TrackConditions.General.TCDisplay.VirtualSBIForTarget
(
    Distance =&gt; Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ),
    Target =&gt; Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.Target
    {
        Location =&gt; 2000.0,
        Speed =&gt; 0.0,
        Length =&gt; 0.0
    }
) &gt; Odometry.EstimatedSpeed</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="ad21ac9a-f680-433e-84c3-9bfab46645c9"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions == []</Expectation></Expectations>
</SubStep><SubStep
 Name="Sub-step2 - The first SBI limit is crossed but D point not crossed yet =&gt; announcement is displayed"
 Guid="da05d6dc-0167-45a9-88fb-4da0227b50f0"
>
<Comment></Comment>
<Actions>
<Action
 Guid="e70963d5-f505-460b-9d0c-72383a12c030"
>Odometry.NominalDistance &lt;- 1970.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="9e00570a-c4a4-4fef-b724-30a12b59c331"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions != []
  AND
( COUNT DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ) == 1
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).IsAnnouncement
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).Type == Kernel.TrackDescription.TrackConditions.General.TCDisplay.TCTypeEnum.NonStoppingArea</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="8ec01a32-aee6-4f53-901d-c770319b5da7"
>Kernel.TrackDescription.TrackConditions.General.TCDisplay.VirtualSBIForTarget
(
    Distance =&gt; Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ),
    Target =&gt; Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.Target
    {
        Location =&gt; 2000.0,
        Speed =&gt; 0.0,
        Length =&gt; 0.0
    }
) &lt;= Odometry.EstimatedSpeed</Expectation></Expectations>
</SubStep><SubStep
 Name="Sub-step3 - Before point D =&gt; the announcement is still displayed, non stopping area not displayed"
 Guid="41be7fb1-2b72-47da-8503-ff15e5e2ad69"
>
<Actions>
<Action
 Guid="fcb57132-bfad-419a-a535-8120a08dc155"
>Odometry.NominalDistance &lt;- 2088.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="32b63e11-2b01-4fbb-916f-5516db91e5f3"
>Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ) == 1999.0</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="43510d22-e133-42de-9f35-1bb01ff12356"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions != []
  AND
( COUNT DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ) == 1
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).IsAnnouncement
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).Type == Kernel.TrackDescription.TrackConditions.General.TCDisplay.TCTypeEnum.NonStoppingArea</Expectation></Expectations>
</SubStep><SubStep
 Name="Sub-step4 - At point D =&gt; the announcement is not displayed anymore, the track condition is displayed"
 Guid="6cb4c63f-63f8-4a04-837d-f07ac968020e"
>
<Actions>
<Action
 Guid="d39c5e99-f30d-440d-8771-a53e4f52f231"
><Comment></Comment>
Odometry.NominalDistance &lt;- 2089.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="3676d519-5d6c-4e19-8670-e36c0e77931c"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions != []
  AND
( COUNT DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ) == 1
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).IsAnnouncement == False
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).Type == Kernel.TrackDescription.TrackConditions.General.TCDisplay.TCTypeEnum.NonStoppingArea</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="b510dad6-aa16-4bc9-80d4-597c5f30ef9f"
>Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ) == 2000.0</Expectation></Expectations>
</SubStep><SubStep
 Name="Sub-step5 - The second SBI is not crossed yet =&gt; the track conditions is displayed"
 Guid="8c4ca5d0-6630-413c-a1f7-c247ed5e0683"
>
<Actions>
<Action
 Guid="48a7add8-956c-499b-85d4-453b3741ef1b"
>Odometry.NominalDistance &lt;- 2769.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="9a3d6a59-3dee-4677-8ebd-e4bdc3781542"
>Kernel.TrackDescription.TrackConditions.General.TCDisplay.VirtualSBIForTarget
(
    Distance =&gt; Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ),
    Target =&gt; Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.Target
    {
        Location =&gt; 2000.0 + 400.0 + Kernel.TrainData.TrainData.Value.TrainLength,
        Speed =&gt; 0.0,
        Length =&gt; 0.0
    }
) &gt; Odometry.EstimatedSpeed</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="6307c5f2-2a69-48e2-a222-057ff3b7a45f"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions != []
  AND
( COUNT DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ) == 1
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).IsAnnouncement == False
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).Type == Kernel.TrackDescription.TrackConditions.General.TCDisplay.TCTypeEnum.NonStoppingArea</Expectation></Expectations>
</SubStep><SubStep
 Name="Sub-step6 - The second SBI is crossed =&gt; nothing is displayed"
 Guid="f78b98f9-2fc9-4c09-b6b8-7a60d36a338b"
>
<Actions>
<Action
 Guid="3ff6bfa5-d60d-4842-a774-48aa9baf0481"
>Odometry.NominalDistance &lt;- 2770.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="1298078d-64d2-4ac5-b98b-2f3e471606e6"
>Kernel.TrackDescription.TrackConditions.General.TCDisplay.VirtualSBIForTarget
(
    Distance =&gt; Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ),
    Target =&gt; Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.Target
    {
        Location =&gt; 2000.0 + 400.0 + Kernel.TrainData.TrainData.Value.TrainLength,
        Speed =&gt; 0.0,
        Length =&gt; 0.0
    }
) &lt;= Odometry.EstimatedSpeed</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="fd9d12c4-d79b-406f-b6d0-a7fa52696d60"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions == []</Expectation></Expectations>
</SubStep></SubSteps>
</Step><Step
 IO="NA"
 LevelIN="NA"
 LevelOUT="NA"
 ModeIN="NA"
 ModeOUT="NA"
 Name="Step4 - Provide data for degraded case and check expectations"
 Guid="b1ff3489-6786-4de7-bb28-60ff833799f0"
>
<SubSteps>
<SubStep
 Name="Sub-step1 - The driver uses the brakes =&gt; the speed descreases and the train enters the area between the first and the second SBI"
 Guid="4a01ed4f-c623-40ef-9178-c1388af38be1"
>
<Comment>The driver uses brakes and the train speed decreases to 51.0, so the train enters the area between the first and the second SBI again, but nothing is displayed.</Comment>
<Actions>
<Action
 Guid="9910e75f-b279-4cff-9592-5cb3e9364737"
>Odometry.EstimatedSpeed &lt;- 51.0</Action></Actions>
<Expectations>
<Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="47ad158c-3bcf-4ff0-b5b8-8d8be733c679"
>Kernel.TrackDescription.TrackConditions.General.TCDisplay.VirtualSBIForTarget
(
    Distance =&gt; Kernel.TrainPosition.FrontEndPosition ( PointOfInterest=&gt;DistanceInterval.Max ),
    Target =&gt; Kernel.SpeedAndDistanceMonitoring.TargetSpeedMonitoring.Target
    {
        Location =&gt; 2000.0 + 400.0 + Kernel.TrainData.TrainData.Value.TrainLength,
        Speed =&gt; 0.0,
        Length =&gt; 0.0
    }
) &gt; Odometry.EstimatedSpeed</Expectation><Expectation
 Kind="Instantaneous"
 DeadLine="1"
 Guid="1b4e9e32-326d-416d-b009-50e30e8186a4"
>DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.OutputInformation.DisplayRequested == True
  AND
DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions != []
  AND
( COUNT DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ) == 1
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).IsAnnouncement == False
  AND
( FIRST_IN DMI.MasterDMI().Out_TrackConditionsWithSoundHorn.ActiveConditions ).Type == Kernel.TrackDescription.TrackConditions.General.TCDisplay.TCTypeEnum.NonStoppingArea</Expectation></Expectations>
</SubStep></SubSteps>
</Step></Steps>
</TestCase></TestCases>
</SubSequence></SubSequences>
</Frame>
