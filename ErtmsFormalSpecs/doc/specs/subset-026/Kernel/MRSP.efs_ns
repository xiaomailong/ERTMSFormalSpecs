<NameSpace
 X="120"
 Y="770"
 Width="100"
 Height="50"
 Pinned="TRUE"
 Name="MRSP"
 Guid="f0c4da0d-ec84-47ac-bd70-102fbca865c0"
>
<NameSpaces>
</NameSpaces>
<Functions>
<Function
 Type="Default.BaseTypes.Speed"
 Cacheable="TRUE"
 Default=""
 Width="100"
 Height="50"
 Implemented="TRUE"
 NeedsRequirement="FALSE"
 Name="SpeedRestrictions"
 Guid="588be3ea-fbf4-46fc-974a-f39f002c0eaf"
>
<ReqRef
 Id="7cb799f0-c388-4d0f-89fc-d6b44597da3d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="196cad35-fe5b-4133-a204-51434e7caa9d"
>
</ReqRef><ReqRef
 Id="6c7cb844-1387-4693-8b9c-f27e4a5bc4f0"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="f8dcace0-f703-45f9-9ee6-9d507a717bb5"
>
</ReqRef><ReqRef
 Id="eefe4c22-e047-4793-8751-86326008b087"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="48bfc561-0afc-44b7-a651-16315d1a667c"
>
</ReqRef><ReqRef
 Id="6bec99f1-c63b-4029-8e0c-10a723b3ff86"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3d189dd3-8f3f-4487-a032-e6ab1b430923"
>
</ReqRef><ReqRef
 Id="34c41066-5e35-4d22-8ff2-bded60983243"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b966760f-b56a-42e7-90e4-0e5d46eb6c60"
>
</ReqRef><ReqRef
 Id="0a69aa11-8088-4606-a5c6-521d3d7074c8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="5f596ca5-2391-4d0a-bac8-abd8479aa4ef"
>
</ReqRef><ReqRef
 Id="2bead7ec-ab1a-43c8-94ed-46ec4681a9b8"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c47803d5-c43e-4c10-8a8d-db37f78b7609"
>
</ReqRef><ReqRef
 Id="4f903ab1-ca58-4171-a91a-e6c23000fe4e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="b60b2a66-dc30-4270-8cf2-04a77eac3e48"
>
</ReqRef><ReqRef
 Id="04a0794a-23c9-4383-8869-f2d8e4aab882"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="7c615486-3830-4c73-8cf7-321adb28ac3e"
>
</ReqRef><ReqRef
 Id="bfa09769-fb03-456f-b92b-14ab4cf7977b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="880003ee-bf89-49f9-aa93-ba4ec01f1243"
>
</ReqRef><ReqRef
 Id="b2a3ff3a-3f41-4dde-9bf8-ee649ce14d86"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="47d63b8d-433c-4e10-b388-b126f1f1181b"
>
</ReqRef><ReqRef
 Id="1d80a2a9-35e8-42c0-b7af-767e7c110d32"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6b52d4c5-15a7-4724-b465-09e30e8d7cf7"
>
</ReqRef><ReqRef
 Id="0b1f3e7f-3acf-435f-8d5e-c7e079fd5ed6"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="05ac2453-d944-4523-80d3-0599c9671eac"
>
</ReqRef><ReqRef
 Id="ca1c598d-015e-44b0-9659-1a4c483f22b5"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="23d3d834-b1d1-4a3c-b1a1-640000c22362"
>
</ReqRef><Comment>Provides the speed restrictions associated to the MRSP</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="distance"
 Guid="d4e25139-f6ac-41b0-a5a7-6ea2ae8ad00a"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Value"
 Guid="0ef9f3fa-fd51-4d90-bee3-3b0b79a43bba"
>
<Expression>MIN (
    MIN (
        MIN (
            MIN ( LX, SignallingRelatedSpeedRestrictions),
            MIN ( TSR, ModeSpeedRestrictions )
        ),
        MIN (
            MIN ( NationalValues.OverrideRelatedSpeedRestrictions, TrainSpeedRestrictions ),
            MIN ( STMMaxSpeed, STMSystemSpeed )
        )
    ),
    MIN (
        MIN ( ASP, SSP),
        PermittedBrakingDistance
    )
)
(distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="550"
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="SSP"
 Guid="756910e4-3fd6-4d61-8bda-69ed47605cd0"
>
<ReqRef
 Id="3e4a183c-969d-4574-ac8c-666dd8215c79"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="c0f56a8d-be15-45f9-bfbe-57378d50d225"
>
</ReqRef><ReqRef
 Id="bfa09769-fb03-456f-b92b-14ab4cf7977b"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="13492f43-590f-4b59-98d5-d5ecaafd710c"
>
</ReqRef><ReqRef
 Id="b2a3ff3a-3f41-4dde-9bf8-ee649ce14d86"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="9376a060-b8a8-40ba-ac3f-fed88f92a573"
>
</ReqRef><ReqRef
 Id="17d2fc17-9c74-4023-89f7-70fa5b6baa44"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ac60a7da-bc04-4971-91a8-bb3ac3fd8033"
>
</ReqRef><Comment>Provides the speed restrictions profile due to static speed profile.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="5e2f7104-f18c-4796-aef0-b1d9f05fa0a9"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on SSP"
 Guid="a56d8310-6088-4c84-901e-802ee6a51411"
>
<PreConditions>
<PreCondition
 Guid="9c611a6f-df2e-4e2f-bf8f-20997d5882ce"
>ActiveFunctions.DetermineMRSP_SSP()</PreCondition></PreConditions>
<Expression>TrackDescription.StaticSpeedProfile.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="21c6f6ca-ebc7-4d7e-bc18-dff3dbf19563"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="440"
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ASP"
 Guid="7ca01db3-9970-4d39-9993-37103fde3ee2"
>
<ReqRef
 Id="4cf37699-f0e2-4e3e-a1ef-3a1aea8ab8c4"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ce51029d-02d7-43c2-b312-cceac34b5e68"
>
</ReqRef><Comment>Provides the speed restrictions profile due to Axle Load speed profile.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="dd710535-5543-468a-892a-16573f16d9b0"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on ASP"
 Guid="ff1572ce-8a3b-441e-aa40-aaf9e448a45b"
>
<PreConditions>
<PreCondition
 Guid="fbca48e8-6e6d-42e1-a98f-0dd50873b093"
>ActiveFunctions.DetermineMRSP_ASP()</PreCondition></PreConditions>
<Expression>TrackDescription.AxleLoad.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="d201c15f-2c29-44eb-b391-908c3d0a7c09"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="110"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="TSR"
 Guid="f6c24106-1f33-4b53-9e88-f3575ad86cfa"
>
<ReqRef
 Id="026b002d-138f-435c-9682-ff5ff4bf848f"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="fb921fce-8a8b-4d42-83bc-3370b89ba015"
>
</ReqRef><ReqRef
 Id="433f8899-ea5b-4c49-bde0-bc267a9845bc"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="18ea60ec-edcd-4034-9b54-8a4549632d74"
>
</ReqRef><Comment>Provides the speed restrictions profile due to Temporary Speed Restrictions.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="98d2cb7c-8456-4d01-8b9d-92155f5396f5"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on TSR"
 Guid="938f00dd-f664-4047-a0e9-f0bd46c6a6b8"
>
<PreConditions>
<PreCondition
 Guid="4d666a6e-3351-4086-a912-787a938d6df7"
>ActiveFunctions.DetermineMRSP_TSR()</PreCondition></PreConditions>
<Expression>TSR.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="6c286171-2a14-477e-91e7-2c8cfc4a4a9a"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="220"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="SignallingRelatedSpeedRestrictions"
 Guid="796fae98-ed13-46e3-9f5c-47eee5e0baf9"
>
<ReqRef
 Id="52c6602a-87c2-45d3-8081-379df7d8c12d"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="6a6c42ce-741e-4c83-81fa-d65099d43c89"
>
</ReqRef><Comment>Provides the speed restrictions profile due to Signalling Related Speed Restrictions.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="17952076-452c-4fcc-9b54-4e6cfa8210ae"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on signalling"
 Guid="cfca811a-1a30-4e6e-a4e1-492d48f8d0de"
>
<PreConditions>
<PreCondition
 Guid="217c0fac-2ade-4f20-b580-dad8d6de33fb"
>ActiveFunctions.DetermineMRSP_SignallingSpeedRestriction()</PreCondition></PreConditions>
<Expression>MA.SignallingRelatedSpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="221845fc-c05a-4673-afc4-cce2ff7d7bdc"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="330"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="ModeSpeedRestrictions"
 Guid="b7402cd3-4c2c-4916-9c94-5eb887d8e92a"
>
<ReqRef
 Id="13a2f9eb-3a87-4ed5-a23d-74d70b56770e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="4583eabc-297b-479c-9f2f-bcade095eeef"
>
</ReqRef><Comment>Provides the speed restrictions profile due to Mode related speed restrictions.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="2e6eb2b6-ddda-473b-a235-f43acf54adae"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on mode"
 Guid="1efe70ec-c255-40bb-a621-ca7aca342ef7"
>
<PreConditions>
<PreCondition
 Guid="0f4d6de6-55c4-4b6b-9888-52cd44617230"
>ActiveFunctions.DetermineMRSP_ModeRelatedSpeedRestriction()</PreCondition></PreConditions>
<Expression>ModeRelatedSpeedLimits.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="d56efae3-4440-4565-90fd-ea184918e4ac"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="440"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="TrainSpeedRestrictions"
 Guid="d2547a72-e9c7-4531-a128-c8fc52319edb"
>
<ReqRef
 Id="e402d9f2-dca9-4e92-a4ce-876ba07ce324"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="00238622-7093-4aa8-b357-013dc1191ea4"
>
</ReqRef><Comment>Provides the speed restrictions profile due to train characteristics.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="8fa5617e-5734-46bf-96eb-5bdb4247fad7"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on train characteristics"
 Guid="8e298c71-a2d4-4e89-98bb-c7a037aec930"
>
<PreConditions>
<PreCondition
 Guid="d97d46cb-74ec-4da7-9fb3-68af9fa91f66"
>ActiveFunctions.DetermineMRSP_TrainRelatedSpeedRestrictions()</PreCondition></PreConditions>
<Expression>TrainData.TrainData.Value.MaximumSpeed</Expression>
</Case><Case
 Name="Otherwise"
 Guid="98942360-17db-494c-9f88-4d04649ad934"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="550"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="STMMaxSpeed"
 Guid="54b934f6-fbce-47d2-a8db-3484b0cb25ad"
>
<ReqRef
 Id="2aa5f509-4651-4dd4-a3fe-1aca62c7e1a9"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="3ebeac8e-b168-448c-a02c-fa77a5d9d4a6"
>
</ReqRef><Comment>Provides the speed restrictions profile due to STM max speed.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="f57a562b-c920-4e03-ac27-e1dc8c80a38b"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on STM max speed"
 Guid="681ec411-f2d8-4efb-8cf2-34c45c035446"
>
<PreConditions>
<PreCondition
 Guid="2755f693-13d4-4b3d-965c-1e0e971dd153"
>ActiveFunctions.DetermineMRSP_STMMaxSpeed()</PreCondition></PreConditions>
<Expression>STM.MaxSpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="9472b77b-7266-4341-aa1a-512b1073a79a"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="110"
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="STMSystemSpeed"
 Guid="6c62e24f-8aa9-4a2a-9c8e-6cd59713c91f"
>
<ReqRef
 Id="990c13fc-a328-4478-8d10-92f524b401f1"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="ce9b0373-349c-49da-883b-9a01bbe0f756"
>
</ReqRef><Comment>Provides the speed restrictions profile due to STM system speed.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="96015888-4eb7-4793-afa4-aeb663c25af1"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on STM max speed"
 Guid="90481baa-a29d-4d43-8ee3-aa902eed7a4b"
>
<PreConditions>
<PreCondition
 Guid="1b82e7a7-ee5e-4cd6-a51c-6272ba4f6eb8"
>ActiveFunctions.DetermineMRSP_STMSystemSpeed()</PreCondition></PreConditions>
<Expression>STM.SystemSpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="2b277c4e-9c14-424b-b1bc-f9a37db0155e"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="220"
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="LX"
 Guid="441c38fb-645b-40f8-a2de-d6b1c2e89a02"
>
<ReqRef
 Id="e9b3c91e-9583-46f0-90d8-f49c8b6e4ff7"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="a25a97dc-1989-45fa-aec5-382698a72b17"
>
</ReqRef><Comment>Provides the speed restrictions profile due to level crossings.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="73ebebcf-5006-4da6-8e61-3dcc165a2032"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on LX"
 Guid="f39163ac-3c70-42f3-8531-030c375ae501"
>
<PreConditions>
<PreCondition
 Guid="36b4cc3f-3353-4a68-b38b-cf419ffc0209"
>ActiveFunctions.DetermineMRSP_LXSpeed()</PreCondition></PreConditions>
<Expression>LX.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="fe3e9470-2855-4370-be07-819c816aa197"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Default=""
 X="330"
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="PermittedBrakingDistance"
 Guid="ef681195-f161-41bc-a1a4-06aa670e8a53"
>
<ReqRef
 Id="43276136-8bff-4532-be60-47b0198243cb"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="2f1db9e4-b6fd-45da-9143-653dea0cacf4"
>
</ReqRef><Comment>Provides the speed restrictions profile due to speed restrictions to esure permitted braking distances.</Comment>
<Parameters>
<Parameter
 Type="Default.BaseTypes.Distance"
 Name="Distance"
 Guid="0bce4a55-c5be-4eb6-beb6-e66eed4bbe03"
>
</Parameter></Parameters>
<Cases>
<Case
 Name="Determine MRSP based on LX"
 Guid="a51be4c2-3902-4fd0-a9d1-768366a7e88a"
>
<PreConditions>
<PreCondition
 Guid="d2179e9a-ccd3-4ca6-b2fa-2fc6f66c21bf"
>ActiveFunctions.DetermineMRSP_PermittedBrakingDistance()</PreCondition></PreConditions>
<Expression>TrackDescription.PermittedBrakingDistance.SpeedRestrictions(Distance)</Expression>
</Case><Case
 Name="Otherwise"
 Guid="12bd886d-b409-48db-9953-70c1864244cb"
>
<Expression>BaseTypes.MaxSpeedFunction(Distance)</Expression>
</Case></Cases>
</Function><Function
 Type="Default.BaseTypes.Speed"
 Cacheable="TRUE"
 Default=""
 Y="60"
 Width="100"
 Height="50"
 Implemented="TRUE"
 Name="V_MRSP"
 Guid="48eb7335-9933-444f-b34f-5a1529d1baa7"
>
<ReqRef
 Id="7da2c959-4215-45b4-b239-3b315d76277c"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="bc56ed5b-9004-4e41-bd0c-78505480489e"
>
</ReqRef><ReqRef
 Id="5da2e749-a3e2-4dba-99b5-f766189c6f3e"
 SpecId="1725280b-f696-4860-94cc-d85f62c35214"
 Guid="d6d390ff-4f4e-4618-a6a5-d0dc406a5b50"
>
</ReqRef><Comment>Returns the value of V_MRSP as used in the speed and distance monitoring commands</Comment>
<Cases>
<Case
 Name="Valid position"
 Guid="bc9e2802-635d-43c8-8a44-6790d4a05f49"
>
<PreConditions>
<PreCondition
 Guid="3cba845a-5194-47da-81ff-78d368523184"
>TrainPosition.Position.DataState == DataState.Valid</PreCondition></PreConditions>
<Expression>REDUCE
  TARGETS(
    Targets1 =&gt; SpeedRestrictions,
    Targets2 =&gt; EMPTY,
    Targets3 =&gt; EMPTY
) | TrainPosition.FrontEndPosition(DistanceInterval.Min) &lt; X.Location  AND  X.Location &lt;= TrainPosition.FrontEndPosition(DistanceInterval.Max)
USING X IN
  BaseTypes.MinSpeed(
    X1 =&gt; X.Speed,
    X2 =&gt; RESULT
)
INITIAL_VALUE
  SpeedRestrictions(BaseTypes.MaxDistance(
    X1=&gt;TrainPosition.FrontEndPosition(DistanceInterval.Min),
    X2=&gt;0.0
))</Expression>
</Case><Case
 Name="In SR Mode, position invalid/unknown"
 Guid="07155ae8-2f98-4cd3-b826-b02b15070446"
>
<PreConditions>
<PreCondition
 Guid="db1088b1-47d7-48cc-82ea-d54ec2ee1683"
>Mode == Mode.SR</PreCondition></PreConditions>
<Expression>SpeedRestrictions(BaseTypes.MaxDistance(
    X1 =&gt; Odometry.NominalDistance - TrainPosition.SRStartDistance,
    X2 =&gt; 0.0
))</Expression>
</Case><Case
 Name="Otherwise"
 Guid="60205dfa-dfa9-4ea2-8fea-039c02eb562d"
>
<Expression>BaseTypes.Speed.NA</Expression>
</Case></Cases>
</Function></Functions>
</NameSpace>
